<!DOCTYPE html>
<html>
<head>
    <title>Son of Son of Exercise 4</title>

    <script type="text/javascript" src="/apps/2.0rc1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",launch:function(){this.getData()},getData:function(){var myFilter=Ext.create("Rally.data.QueryFilter",{property:"Disabled",operator:"=",value:"false"});console.log(""+myFilter);var store=Ext.create("Rally.data.WsapiDataStore",{model:"User",listeners:{load:function(store,data,success){console.log(data),this.aggregateData(data)},scope:this},filters:[myFilter],autoLoad:!0,fetch:["Department"],limit:1/0})},aggregateData:function(userRecords){var deptGroupData=_.countBy(userRecords,function(record){return record.get("Department")});console.log(deptGroupData),this.renderChart(deptGroupData)},renderChart:function(myData){var myChartConfig={chart:{type:"column"},title:{text:"License Usage by Department"},subtitle:{text:"Count by User Department"},xAxis:{categories:["Department"]},yAxis:{min:0,title:{text:"Active User Count"}},tooltip:{headerFormat:"<table>",pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y}</b></td></tr>',footerFormat:"</table>",shared:!1,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}}},series=[];Ext.Object.each(myData,function(key,value){series.push({name:key,data:[value]})});var myChartData={series:series},myChart=Ext.create("Rally.ui.chart.Chart",{chartConfig:myChartConfig,chartData:myChartData});this.add(myChart)}});

            Rally.launchApp('CustomApp', {
                name:"Son of Son of Exercise 4",
	            parentRepos:"RallyCommunity/RallyCertifiedDeveloperExercise4,deadflycake/Ex4"
            });

        });
    </script>


    <style type="text/css">
        .app {
     /* Add app styles here */
}

    </style>
</head>
<body></body>
</html>
